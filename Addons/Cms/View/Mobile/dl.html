<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><![endif]-->
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0">
	<title>www.2690.cn</title>
	<meta name="description" content="Dragonfruit is one of the free HTML5 Templates from templatemo. It is a parallax layout with jQuery slider, events, and timeline." />
	<meta name="author" content="templatemo">
	<!-- Favicon-->
	<link rel="icon" href="http://www.2690.cn/images/ico/favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" href="http://www.2690.cn/images/ico/favicon.ico" type="image/x-icon" />
	<link href="css/mui.min.css" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="css/data-styles.css" media="all">
	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="js/data-moment.js"></script>
	<script type="text/javascript" src="js/bootstrap-datetimepicker.js"></script>
	<script src="__ROOT__/Addons/Cms/View/Public/js/zepto.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="__ROOT__/Addons/Cms/View/Public/js/qrcode.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="__ROOT__/Addons/Cms/View/Public/js/token.js" type="text/javascript" charset="utf-8"></script>

	<script type="text/javascript">
        $(document).ready(function(){
            if($(".iDate.date").length>0){
                $(".iDate.date").datetimepicker({
                    locale:"zh-cn",
                    format:"YYYY-MM-DD",
                    dayViewHeaderFormat:"YYYY年 MMMM"
                });
            }
        })
	</script>
</head>

<body>
<!--导航条-->
<!--<header class="mui-bar mui-bar-nav" style="position: fixed;">

    <div class="col-xs-4 col-sm-4">
        <if condition="$user.user_login eq ''">
            <a style="color: white;line-height: 3.5rem;" class="pull-right" href="?a=login">登录</a>
        <else />
            <a style="color: white;line-height: 3.5rem;"><div id="login_name">{$user.user_login}</div></a>
            <a style="color: white;line-height: 3.5rem;" class="pull-right" href="?g=user&m=login&a=logout">退出</a>
        </if>
    </div>

</header>-->
<div class='wx-btn mui-btn mui-btn-primary'>点击生成二维码分享</div>
<div class="xcBox" id="xcBox">
	<div id="qrcode"></div>
	<canvas id="myCanvas"></canvas>
</div>
<center>
	<span>日期：</span>
	<div class="iDate date">
		<input type="text">
		<button type="button" class="addOn"></button>
	</div>
	<div class="iDate date">
		<input type="text">
		<button type="button" class="addOn"></button>
	</div>
	<button class='mui-btn mui-btn-primary'>搜索</button>
</center>
<div style='padding: 10px 0 0 15px'>
	总合计：<span>￥12312463718245</span>
</div>
<div class="mui-content">
	<div class="mui-card">
		<ul class="mui-table-view mui-table-view-chevron">
			<li class="mui-table-view-cell">一级代理
				<ul class="mui-table-view mui-table-view-chevron">
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhskjdhf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">一级合计：￥234234
					</li>
				</ul>
			</li>
		</ul>
	</div>
</div>
<div class="mui-content">
	<div class="mui-card">
		<ul class="mui-table-view mui-table-view-chevron">
			<li class="mui-table-view-cell">二级代理
				<ul class="mui-table-view mui-table-view-chevron">
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhskjdhf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhsk</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdskjdhf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhskjdhfghfghfgf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">二级合计：￥2342342342
					</li>
				</ul>
			</li>
		</ul>
	</div>
</div>
<div class="mui-content">
	<div class="mui-card">
		<ul class="mui-table-view mui-table-view-chevron">
			<li class="mui-table-view-cell">三级代理
				<ul class="mui-table-view mui-table-view-chevron">
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhskjdhf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">
						<div class='mui-row'>
							<div class='mui-col-sm-8 mui-col-xs-8'>sdfhskjdhf</div>
							<div class='mui-col-sm-4 mui-col-xs-4'>￥234234</div>
						</div>
					</li>
					<li class="mui-table-view-cell">三级合计：￥234234
					</li>
				</ul>
			</li>
		</ul>
	</div>
</div>
</body>
<script>
    //判断是否微信登录
    if({$wechat}=='1'){
        $(".singleCopyText").css('display','block');
    }else{
        $(".singleCopyText").css('display','none');
    }
    window.addEventListener('toggle', function(event) {
        if (event.target.id === 'M_Toggle') {
            var isActive = event.detail.isActive;
            var table = document.querySelector('.mui-table-view');
            var card = document.querySelector('.mui-card');
            if (isActive) {
                card.appendChild(table);
                card.style.display = '';
            } else {
                var content = document.querySelector('.mui-content');
                content.insertBefore(table, card);
                card.style.display = 'none';
            }
        }
    });

    $('.wx-btn').on("click", function() {
        $(".loading").show();
        var params = {};
        var apiHomeSrc = location.origin;
        $.ajax({
            type: "POST",
            url: apiHomeSrc + '/addon/Cms/Mobile/user_userCodeUrl',
            contentType: "application/json",
            data: JSON.stringify(params),
            dataType: "json",
            beforeSend: function(request) {
                request.setRequestHeader("X-Auth-Token", token)
            },
            success: function(data) {
                erw = data.data;
                var qrcode = new QRCode(document.getElementById("qrcode"), {
                    width: 250,
                    height: 250
                });
                qrcode.makeCode(erw);
                var c = document.getElementsByTagName("canvas")[0];
                img1 = convertCanvasToImage(c);
                $('#qrcode').hide();
                date(a, b)
            },
            error: function(error) {}
        })
    });
    function setOtherRecord(data) {}

    function date(a, b) {
        var Mycanvas = document.getElementById("myCanvas");
        ct = Mycanvas.getContext("2d");
        ct.rect(0, 0, Mycanvas.width, Mycanvas.height);
        ct.fill();

        function draw(n) {
            if(n < 2) {
                var img = new Image;
                if(n == 1) {
                    img.src = img1.src
                } else {
                    img.src = "/Addons/Cms/View/Public/img/xuanchuan1.png" ;
                }
                img.onload = function() {
                    if(n == 1) {
                        ct.drawImage(this, b * 0.3334, a * 0.595, b * 0.33, a * 0.22)
                    } else {
                        ct.drawImage(this, 0, 0, b, a);
                        ct.font = "25px 黑体";
                        ct.fillStyle = "#FFFFFF";
                        ct.fillText($('.l-hd-left span').text(), b * 0.1, a * 0.07)
                    }
                    draw(n + 1)
                }
            } else {
                base64.push(Mycanvas.toDataURL("image/png"));
                document.getElementById("xcBox").innerHTML = '<img src="' + base64[0] + '">';
                $('.xcBox').show();
                $('.xc').show();
                $(".loading").hide()
            }
        }
        window.onload = draw(0)
    }

    function convertCanvasToImage(canvas) {
        var image = new Image();
        image.src = canvas.toDataURL("image/png");
        return image
    }
</script>
</html>